Select Case pVal.ColUID
            Case "colSUPAMT"
                oForm.Freeze(True)


                Dim supAMT As Double = 0
                supAMT = oMatrix.Columns.Item("colSUPAMT").Cells.Item(pVal.Row).Specific.Value() '공급가액
                oDbSrc.SetValue("U_SUPAMT", pVal.Row - 1, supAMT) '공급가 금액 DB에 설정
                
                Dim vatGRP As String = oMatrix.Columns.Item("colVATGRP").Cells.Item(pVal.Row).Specific.Value() '세금그룹
                oDbSrc.SetValue("U_VATGROUP", pVal.Row - 1, vatGRP)

                '------세금그룹을 통해 세율을 구하기 위한 코드--------

                Dim xSQL As String = "select Rate from OVTG where Code = 'USER_CODE'"
                xSQL = xSQL.Replace("USER_CODE", vatGRP)

                Dim vatRate As Double
                If CFL.GetValue(xSQL) = "" Then
                    vatRate = 0
                Else
                    vatRate = CFL.GetValue(xSQL)
                End If



                Dim vatAMT As Double = 0


                If oDbSrc.GetValue("U_VAT", pVal.Row - 1) <> 0 Then
                    vatAMT = oDbSrc.GetValue("U_VAT", pVal.Row - 1)
                Else
                    If vatRate <> 0 Then
                        vatAMT = supAMT * vatRate * 0.01  '백분율을 적용하기 위해 0.01을 곱해준다, 세금 = 공급가액 * 세율
                    Else
                        vatAMT = 0

                    End If
                End If


                'oMatrix.Columns.Item("colVATAMT").Cells.Item(pVal.Row).Specific.Value = vatAMT '세금 금액 매트릭스에 설정


                oDbSrc.SetValue("U_VAT", pVal.Row - 1, vatAMT) '세금 금액 DB에 설정

                v_TOTAMT_d = supAMT + vatAMT '총 합계액

                oDbSrc.SetValue("U_SVCAMT", pVal.Row - 1, v_TOTAMT_d) '합계액 DB에 설정
                oMatrix.LoadFromDataSource() '데이터값들을 DB에서 불러와 매트릭스로 옮긴다.
